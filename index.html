<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <!-- <script src="audio.js" defer></script> -->
    <title>useless</title>
  </head>
  <body>
    <button id="start">Start Audio</button>
    <button id="stop">Stop Audio</button>
    <label for="volume">Volume</label>
    <input
      id="volume"
      name="volume"
      type="range"
      min="0"
      max=".8"
      value="0"
      step=".01"
    />
    <input type="number" id="freq" name="freq" value="220" />
    <script>
      const volume = document.querySelector("input[id='volume']");
      const freq = document.querySelector("input[id='freq']");
      const startButton = document.querySelector("button[id='start']");
      const stopButton = document.querySelector("button[id='stop']");
      const audioContext = new AudioContext();
      audioContext.suspend();

      let masterVolume = audioContext.createGain();
      let osc = audioContext.createOscillator();

      masterVolume.connect(audioContext.destination);
      osc.connect(masterVolume);

      masterVolume.gain.value = volume.value;
      osc.frequency.value = freq.value;

      osc.start(0);

      startButton.addEventListener("click", () => {
        if (audioContext.state === "suspended") {
          audioContext.resume().then(() => {
            console.log("Resumed audioContext");
          });
        }
      });

      stopButton.addEventListener("click", () => {
        audioContext.suspend();
      });

      volume.addEventListener("change", () => {
        masterVolume.gain.value = volume.value;
      });

      freq.addEventListener("change", () => {
        osc.frequency.value = freq.value;
      });
    </script>
  </body>
</html>
